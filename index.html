<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comal County GOP Watch</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700;800&family=Source+Sans+3:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/shared.css">
    <style>
        /* ‚îÄ‚îÄ Hero ‚îÄ‚îÄ */
        .hero {
            position: relative;
            height: 480px;
            background: linear-gradient(135deg, rgba(27,42,74,0.85), rgba(139,26,26,0.7)),
                url('https://images.unsplash.com/photo-1558618666-fcd25c85f82e?w=1600&q=80') center/cover no-repeat;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: white;
        }

        .hero::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 80px;
            background: linear-gradient(transparent, var(--cream));
        }

        .hero-content {
            position: relative;
            z-index: 1;
            max-width: 800px;
            padding: 0 24px;
        }

        .hero h1 {
            font-size: 56px;
            font-weight: 800;
            line-height: 1.1;
            margin-bottom: 16px;
            text-shadow: 0 2px 12px rgba(0,0,0,0.3);
        }

        .hero p {
            font-size: 20px;
            opacity: 0.95;
            max-width: 600px;
            margin: 0 auto 24px;
        }

        .hero-stars {
            font-size: 28px;
            letter-spacing: 12px;
            opacity: 0.6;
        }

        /* ‚îÄ‚îÄ Star Divider ‚îÄ‚îÄ */
        .star-divider {
            text-align: center;
            margin: 48px 0;
            color: var(--gold);
            font-size: 14px;
            letter-spacing: 8px;
        }

        .star-divider::before,
        .star-divider::after {
            content: '';
            display: inline-block;
            width: 80px;
            height: 1px;
            background: var(--gold);
            vertical-align: middle;
            margin: 0 16px;
        }

        /* ‚îÄ‚îÄ Alert Banner ‚îÄ‚îÄ */
        .alert-banner {
            background: linear-gradient(135deg, var(--red), var(--red-light));
            color: white;
            padding: 20px 32px;
            border-radius: 12px;
            margin: -24px auto 48px;
            max-width: 900px;
            display: flex;
            align-items: center;
            gap: 16px;
            box-shadow: 0 4px 16px rgba(139,26,26,0.3);
            position: relative;
            z-index: 2;
        }

        .alert-banner .alert-icon { font-size: 32px; }
        .alert-banner .alert-text h3 { font-size: 18px; font-family: 'Source Sans 3', sans-serif; font-weight: 700; }
        .alert-banner .alert-text p { opacity: 0.9; font-size: 14px; }

        /* ‚îÄ‚îÄ Feed Sections ‚îÄ‚îÄ */
        .feed-section {
            margin-bottom: 48px;
        }

        .feed-section .section-header {
            text-align: left;
            margin-bottom: 20px;
            display: flex;
            align-items: baseline;
            justify-content: space-between;
        }

        .feed-section .section-header h2 {
            font-size: 28px;
        }

        /* ‚îÄ‚îÄ Officials Grid ‚îÄ‚îÄ */
        .officials-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
        }

        .officials-group {
            background: var(--white);
            border-radius: 12px;
            padding: 28px;
            border: 1px solid var(--border);
            box-shadow: 0 1px 4px rgba(0,0,0,0.06);
        }

        .officials-group h3 {
            font-size: 20px;
            color: var(--navy);
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--gold);
        }

        .official-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 12px;
            border-bottom: 1px solid #f0ebe3;
            gap: 10px;
            text-decoration: none;
            color: inherit;
            border-radius: 8px;
            margin: 0 -12px;
            transition: background 0.2s ease, box-shadow 0.2s ease;
            cursor: pointer;
        }

        .official-row:hover {
            background: rgba(178, 134, 50, 0.08);
            box-shadow: 0 1px 4px rgba(0,0,0,0.06);
        }

        .official-row:last-child { border-bottom: none; }
        .official-row .name { font-weight: 600; color: var(--text); font-size: 14px; flex: 1; text-align: left; }
        .official-row .title { color: var(--text-muted); font-size: 14px; text-align: right; flex-shrink: 0; }

        .official-row .official-photo {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            object-fit: cover;
            flex-shrink: 0;
        }

        /* ‚îÄ‚îÄ Calendar ‚îÄ‚îÄ */
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 16px;
        }

        .calendar-item {
            background: var(--white);
            border-radius: 10px;
            padding: 20px 24px;
            border: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 20px;
            box-shadow: 0 1px 4px rgba(0,0,0,0.04);
        }

        .calendar-item.upcoming {
            border-left: 4px solid var(--gold);
            background: linear-gradient(90deg, #FFFBEB, var(--white));
        }

        .cal-date {
            font-family: 'Playfair Display', serif;
            font-weight: 700;
            font-size: 15px;
            color: var(--navy);
            min-width: 100px;
        }

        .cal-event { font-weight: 500; }

        /* ‚îÄ‚îÄ Responsive ‚îÄ‚îÄ */
        @media (max-width: 900px) {
            .hero { height: 360px; }
            .hero h1 { font-size: 36px; }
            .hero p { font-size: 16px; }
            .officials-section { grid-template-columns: 1fr; }
            .alert-banner { flex-direction: column; text-align: center; margin: -16px 16px 40px; }
            .feed-section .section-header { flex-direction: column; gap: 8px; }
        }

        @media (max-width: 480px) {
            .hero { height: 300px; }
            .hero h1 { font-size: 28px; }
            .calendar-grid { grid-template-columns: 1fr; }
            .star-divider::before, .star-divider::after { width: 40px; }
        }
    </style>
</head>
<body>
    <div id="site-nav"></div>

    <div class="hero">
        <div class="hero-content">
            <div class="hero-stars">‚òÖ ‚òÖ ‚òÖ</div>
            <h1>Comal County GOP Watch</h1>
            <p>Your source for New Braunfels &amp; Comal County Republican politics</p>
            <div class="hero-stars">‚òÖ ‚òÖ ‚òÖ</div>
        </div>
    </div>

    <div class="container">
        <!-- Alert Banner -->
        <div id="alert-banner"></div>

        <!-- Feed Preview: Candidate/Official News -->
        <div class="star-divider">‚òÖ ‚òÖ ‚òÖ</div>
        <div class="feed-section">
            <div class="section-header">
                <h2>üìã Candidate &amp; Official News</h2>
            </div>
            <div id="feed-candidates">
                <p style="color:var(--text-muted);">Loading...</p>
            </div>
        </div>

        <!-- Feed Preview: Public Policy -->
        <div class="star-divider">‚òÖ ‚òÖ ‚òÖ</div>
        <div class="feed-section">
            <div class="section-header">
                <h2>üèõÔ∏è Public Policy &amp; Local Government</h2>
            </div>
            <div id="feed-policy">
                <p style="color:var(--text-muted);">Loading...</p>
            </div>
        </div>

        <!-- Feed Preview: Business Watch -->
        <div class="star-divider">‚òÖ ‚òÖ ‚òÖ</div>
        <div class="feed-section">
            <div class="section-header">
                <h2>üëÅÔ∏è Business Watch</h2>
            </div>
            <div id="feed-business">
                <p style="color:var(--text-muted);">Loading...</p>
            </div>
        </div>

        <!-- Election Calendar -->
        <div id="calendar" class="star-divider">‚òÖ ‚òÖ ‚òÖ</div>
        <div class="section-header">
            <h2>Election Calendar</h2>
            <p>Important dates for the 2026 election cycle</p>
        </div>
        <div id="election-calendar" class="calendar-grid"></div>

        <!-- Current Officials -->
        <div id="officials" class="star-divider">‚òÖ ‚òÖ ‚òÖ</div>
        <div class="section-header">
            <h2>Current Officials</h2>
            <p>Elected representatives serving Comal County</p>
        </div>
        <div id="officials-grid" class="officials-section"></div>
    </div>

    <div id="site-footer"></div>

    <script src="js/utils.js"></script>
    <script src="js/feed-renderer.js"></script>
    <script src="js/layout.js"></script>
    <script>
    (function () {
        'use strict';

        // Load feed previews
        function loadFeedPreview(jsonUrl, containerId, viewAllUrl) {
            var container = document.getElementById(containerId);
            fetchFeed(jsonUrl)
                .then(function (entries) {
                    renderFeedPreview(entries, container, 3, viewAllUrl);
                })
                .catch(function () {
                    container.innerHTML = '<p style="color:var(--text-muted);font-style:italic;">No entries yet.</p>';
                });
        }

        loadFeedPreview('data/candidate-news.json', 'feed-candidates', '/feeds/candidates.html');
        loadFeedPreview('data/policy-feed.json', 'feed-policy', '/feeds/policy.html');
        loadFeedPreview('data/business-watch.json', 'feed-business', '/feeds/business.html');

        // Load officials from JSON
        fetch('data/officials.json')
            .then(function (r) { return r.json(); })
            .then(function (data) {
                renderAlertBanner(data);
                renderElectionCalendar(data);
                renderOfficials(data);
            })
            .catch(function (err) {
                console.error('Failed to load officials data:', err);
            });

        function renderAlertBanner(data) {
            var upcoming = (data.election_calendar || []).filter(function (e) { return e.upcoming; });
            if (upcoming.length > 0) {
                document.getElementById('alert-banner').innerHTML =
                    '<div class="alert-banner">' +
                    '  <div class="alert-icon">üó≥Ô∏è</div>' +
                    '  <div class="alert-text">' +
                    '    <h3>Upcoming: ' + upcoming[0].event + '</h3>' +
                    '    <p>' + upcoming[0].date + ' ‚Äî Mark your calendars and make your voice heard!</p>' +
                    '  </div>' +
                    '</div>';
            }
        }

        function renderElectionCalendar(data) {
            var calEl = document.getElementById('election-calendar');
            var html = '';
            (data.election_calendar || []).forEach(function (item) {
                var cls = item.upcoming ? 'calendar-item upcoming' : 'calendar-item';
                html += '<div class="' + cls + '">' +
                    '<div class="cal-date">' + item.date + '</div>' +
                    '<div class="cal-event">' + item.event + '</div>' +
                    '</div>';
            });
            calEl.innerHTML = html;
        }

        function renderOfficials(data) {
            var gridEl = document.getElementById('officials-grid');
            var officials = data.current_officials || [];
            var city = officials.filter(function (o) { return o.group === 'city'; });
            var countyState = officials.filter(function (o) { return o.group === 'county' || o.group === 'state'; });

            var html = '<div class="officials-group"><h3>City of New Braunfels</h3>';
            city.forEach(function (o) {
                html += officialRow(o);
            });
            html += '</div>';

            html += '<div class="officials-group"><h3>County &amp; State</h3>';
            countyState.forEach(function (o) {
                html += officialRow(o);
            });
            html += '</div>';

            gridEl.innerHTML = html;
        }

        function officialRow(o) {
            var photoHtml = o.photo
                ? '<img class="official-photo" src="' + o.photo + '" alt="' + o.name + '" loading="lazy">'
                : '';
            var link = 'profiles/' + o.slug + '.html';
            var termStr = o.term ? ' (' + o.term + ')' : '';
            return '<a href="' + link + '" class="official-row">' +
                photoHtml +
                '<span class="name">' + o.name + '</span>' +
                '<span class="title">' + o.title + termStr + '</span>' +
                '</a>';
        }
    })();
    </script>
</body>
</html>
