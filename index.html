<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Hill Country Sentinel - Informed Citizens. Accountable Leaders. Your source for New Braunfels and Comal County political news, candidate information, and local government coverage.">
    <meta property="og:title" content="Hill Country Sentinel">
    <meta property="og:description" content="Informed Citizens. Accountable Leaders. - Your source for New Braunfels and Comal County political news, candidate information, and local government coverage.">
    <meta property="og:type" content="website">
    <title>Hill Country Sentinel</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700;800&family=Source+Sans+3:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/shared.css?v=11">
    <style>
        /* ‚îÄ‚îÄ Hero (Courthouse Authority) ‚îÄ‚îÄ */
        .hero {
            position: relative;
            height: 520px;
            background: linear-gradient(135deg, rgba(30,58,95,0.85), rgba(178,34,52,0.75)),
                url('images/courthouse-header.png') center/cover no-repeat;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: white;
            border-bottom: 6px solid var(--red);
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 2px,
                rgba(255,255,255,0.02) 2px,
                rgba(255,255,255,0.02) 4px
            );
        }

        .hero::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 100px;
            background: linear-gradient(transparent, var(--cream));
        }

        .hero-content {
            position: relative;
            z-index: 1;
            max-width: 800px;
            padding: 0 24px;
        }

        .hero h1 {
            font-size: 64px;
            font-weight: 800;
            line-height: 1.05;
            margin-bottom: 20px;
            text-shadow: 0 4px 16px rgba(0,0,0,0.5);
            letter-spacing: -1px;
        }

        .hero p {
            font-size: 22px;
            font-weight: 600;
            opacity: 0.95;
            text-shadow: 0 2px 8px rgba(0,0,0,0.3);
            letter-spacing: 0.3px;
            max-width: 600px;
            margin: 0 auto 28px;
        }

        .hero-stars {
            font-size: 28px;
            letter-spacing: 12px;
            opacity: 0.6;
        }

        /* ‚îÄ‚îÄ Early Voting Alert ‚îÄ‚îÄ */
        .early-voting-alert {
            background: linear-gradient(135deg, var(--gold), var(--gold-light));
            color: white;
            padding: 16px 24px;
            border-radius: 8px;
            margin: 0 auto 24px;
            max-width: 600px;
            text-align: center;
            font-weight: 700;
            font-size: 16px;
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
            box-shadow: 0 4px 12px rgba(184, 134, 11, 0.3);
            animation: pulse-glow 2s ease-in-out infinite alternate;
        }

        @keyframes pulse-glow {
            from { box-shadow: 0 4px 12px rgba(184, 134, 11, 0.3); }
            to { box-shadow: 0 4px 20px rgba(184, 134, 11, 0.5); }
        }

        /* ‚îÄ‚îÄ Star Divider ‚îÄ‚îÄ */
        .star-divider {
            text-align: center;
            margin: 48px 0;
            color: var(--gold);
            font-size: 14px;
            letter-spacing: 8px;
        }

        .star-divider::before,
        .star-divider::after {
            content: '';
            display: inline-block;
            width: 80px;
            height: 1px;
            background: var(--gold);
            vertical-align: middle;
            margin: 0 16px;
        }

        /* ‚îÄ‚îÄ Election Races Section ‚îÄ‚îÄ */
        .races-by-date {
            margin-bottom: 48px;
        }

        .election-date-section {
            margin-bottom: 40px;
            background: var(--cream);
            border-radius: 12px;
            padding: 32px;
            border: 1px solid var(--border);
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        .election-date-section h3 {
            font-size: 24px;
            color: var(--navy-dark);
            margin-bottom: 16px;
            border-bottom: 2px solid var(--red);
            padding-bottom: 8px;
        }

        .compact-race {
            background: var(--white);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 16px;
            border: 1px solid var(--border);
            box-shadow: 0 1px 4px rgba(0,0,0,0.04);
        }

        .compact-race h4 {
            font-size: 18px;
            color: var(--navy);
            margin-bottom: 12px;
            font-weight: 600;
        }

        .candidate-list {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }

        .candidate-chip {
            background: var(--content-bg);
            border: 1px solid var(--content-border);
            border-radius: 20px;
            padding: 8px 16px;
            font-size: 14px;
            font-weight: 500;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s ease;
            text-decoration: none;
            cursor: pointer;
        }

        .candidate-chip:hover {
            background: var(--red);
            color: white;
            border-color: var(--red);
        }

        .candidate-chip.incumbent {
            background: var(--gold);
            color: white;
            border-color: var(--gold);
        }

        .candidate-chip.incumbent:hover {
            background: var(--gold-light);
            border-color: var(--gold-light);
        }

        /* Ensure candidate chips that are anchor tags have consistent styling */
        a.candidate-chip {
            text-decoration: none;
        }
        
        a.candidate-chip:visited {
            color: var(--text);
        }
        
        a.candidate-chip.incumbent:visited {
            color: white;
        }

        .candidate-chip .incumbent-star {
            font-size: 12px;
        }

        /* ‚îÄ‚îÄ Unified News Feed Layout ‚îÄ‚îÄ */
        .news-section {
            margin-bottom: 48px;
        }

        .news-featured-row {
            display: grid;
            grid-template-columns: 3fr 2fr;
            gap: 32px;
            margin-bottom: 32px;
        }

        .featured-story {
            background: var(--white);
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid var(--border);
            box-shadow: 0 4px 16px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            text-decoration: none;
            color: inherit;
            display: block;
        }

        .featured-story:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 32px rgba(0,0,0,0.15);
        }
        
        .featured-story:visited {
            color: inherit;
        }

        .featured-story .story-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .featured-story .story-content {
            padding: 24px;
        }

        .featured-story .story-title {
            font-size: 22px;
            color: var(--text);
            margin-bottom: 12px;
            font-weight: 600;
            line-height: 1.3;
        }

        .featured-story .story-summary {
            color: var(--text-muted);
            font-size: 15px;
            line-height: 1.6;
            margin-bottom: 16px;
        }

        .compact-stories {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .compact-story {
            background: var(--white);
            border-radius: 8px;
            padding: 20px;
            border: 1px solid var(--border);
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            transition: all 0.3s ease;
            text-decoration: none;
            color: inherit;
            display: block;
        }

        .compact-story:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.12);
        }
        
        .compact-story:visited {
            color: inherit;
        }

        .compact-story .story-title {
            font-size: 16px;
            color: var(--text);
            margin-bottom: 8px;
            font-weight: 600;
            line-height: 1.4;
        }

        .story-meta {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 13px;
            color: var(--text-muted);
        }

        .category-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .category-badge.candidates {
            background: var(--red);
            color: white;
        }

        .category-badge.policy {
            background: var(--navy);
            color: white;
        }

        .category-badge.business {
            background: var(--gold);
            color: white;
        }

        .full-width-stories {
            display: grid;
            gap: 16px;
        }

        .full-width-story {
            background: var(--white);
            border-radius: 8px;
            padding: 24px;
            border: 1px solid var(--border);
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            display: flex;
            gap: 20px;
            align-items: flex-start;
            transition: all 0.3s ease;
            text-decoration: none;
            color: inherit;
        }

        .full-width-story:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.12);
        }
        
        .full-width-story:visited {
            color: inherit;
        }

        .full-width-story .story-content {
            flex: 1;
        }

        .full-width-story .story-title {
            font-size: 18px;
            color: var(--text);
            margin-bottom: 8px;
            font-weight: 600;
            line-height: 1.4;
        }

        .full-width-story .story-summary {
            color: var(--text-muted);
            font-size: 14px;
            line-height: 1.6;
            margin-bottom: 12px;
        }

        /* ‚îÄ‚îÄ Alert Banner ‚îÄ‚îÄ */
        .alert-banner {
            background: linear-gradient(135deg, var(--red), var(--red-light));
            color: white;
            padding: 20px 32px;
            border-radius: 12px;
            margin: -24px auto 48px;
            max-width: 900px;
            display: flex;
            align-items: center;
            gap: 16px;
            box-shadow: 0 4px 16px rgba(139,26,26,0.3);
            position: relative;
            z-index: 2;
        }

        .alert-banner .alert-icon { font-size: 32px; }
        .alert-banner .alert-text h3 { font-size: 18px; font-family: 'Source Sans 3', sans-serif; font-weight: 700; }
        .alert-banner .alert-text p { opacity: 0.9; font-size: 14px; }

        /* ‚îÄ‚îÄ Feed Sections ‚îÄ‚îÄ */
        .feed-section {
            margin-bottom: 48px;
        }

        .feed-section .section-header {
            text-align: left;
            margin-bottom: 20px;
            display: flex;
            align-items: baseline;
            justify-content: space-between;
        }

        .feed-section .section-header h2 {
            font-size: 28px;
        }

        /* ‚îÄ‚îÄ Officials Grid ‚îÄ‚îÄ */
        .officials-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
        }

        .officials-group {
            background: var(--white);
            border-radius: 12px;
            padding: 28px;
            border: 1px solid var(--border);
            box-shadow: 0 1px 4px rgba(0,0,0,0.06);
        }

        .officials-group h3 {
            font-size: 20px;
            color: var(--navy);
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--gold);
        }

        .official-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 12px;
            border-bottom: 1px solid #f0ebe3;
            gap: 10px;
            text-decoration: none;
            color: inherit;
            border-radius: 8px;
            margin: 0 -12px;
            transition: background 0.2s ease, box-shadow 0.2s ease;
            cursor: pointer;
        }

        .official-row:hover {
            background: rgba(178, 134, 50, 0.08);
            box-shadow: 0 1px 4px rgba(0,0,0,0.06);
        }

        .official-row:last-child { border-bottom: none; }
        .official-row .name { font-weight: 600; color: var(--text); font-size: 14px; flex: 1; text-align: left; }
        .official-row .title { color: var(--text-muted); font-size: 14px; text-align: right; flex-shrink: 0; }

        .official-row .official-photo {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            object-fit: cover;
            flex-shrink: 0;
        }

        /* ‚îÄ‚îÄ Calendar ‚îÄ‚îÄ */
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 16px;
        }

        .calendar-item {
            background: var(--white);
            border-radius: 10px;
            padding: 20px 24px;
            border: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 20px;
            box-shadow: 0 1px 4px rgba(0,0,0,0.04);
        }

        .calendar-item.upcoming {
            border-left: 4px solid var(--gold);
            background: linear-gradient(90deg, #FFFBEB, var(--white));
        }

        .cal-date {
            font-family: 'Playfair Display', serif;
            font-weight: 700;
            font-size: 15px;
            color: var(--navy);
            min-width: 100px;
        }

        .cal-event { font-weight: 500; }

        /* ‚îÄ‚îÄ Responsive ‚îÄ‚îÄ */
        @media (max-width: 900px) {
            .hero { height: 360px; }
            .hero h1 { font-size: 36px; }
            .hero p { font-size: 16px; }
            .officials-section { grid-template-columns: 1fr; }
            .alert-banner { flex-direction: column; text-align: center; margin: -16px 16px 40px; }
            .feed-section .section-header { flex-direction: column; gap: 8px; }
            .news-featured-row { grid-template-columns: 1fr; }
            .candidate-list { flex-direction: column; }
        }

        @media (max-width: 480px) {
            .hero { height: 300px; }
            .hero h1 { font-size: 28px; }
            .calendar-grid { grid-template-columns: 1fr; }
            .star-divider::before, .star-divider::after { width: 40px; }
            .election-date-section { padding: 20px; }
            .featured-story .story-content { padding: 16px; }
            .full-width-story { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div id="site-nav"></div>

    <div class="hero">
        <div class="hero-content">
            <div class="hero-stars">‚òÖ ‚òÖ ‚òÖ</div>
            <h1>Hill Country Sentinel</h1>
            <p>Informed Citizens. Accountable Leaders.</p>
            <div class="hero-stars">‚òÖ ‚òÖ ‚òÖ</div>
        </div>
    </div>

    <div class="container">
        <!-- Alert Banner -->
        <div id="alert-banner"></div>

        <!-- ELECTION RACES SECTION (TOP PRIORITY) -->
        <div class="star-divider">‚òÖ ‚òÖ ‚òÖ</div>
        <div class="section-header">
            <h2>üó≥Ô∏è 2026 Elections</h2>
            <p>Who's running and when to vote</p>
        </div>

        <div class="races-by-date">
            <!-- PRIMARY ELECTIONS - March 3, 2026 -->
            <div class="election-date-section">
                <h3>Primary Elections ‚Äî March 3, 2026</h3>
                <div class="early-voting-alert">
                    üó≥Ô∏è Early Voting Starts February 17!
                </div>

                <!-- Comal County Commissioner Races -->
                <div class="compact-race">
                    <h4>Comal County Commissioner Precinct 2</h4>
                    <div class="candidate-list">
                        <div class="candidate-chip">Justin Stratemann</div>
                        <div class="candidate-chip">Brian Minus</div>
                        <div class="candidate-chip">Randy Rollins</div>
                    </div>
                </div>

                <div class="compact-race">
                    <h4>Comal County Commissioner Precinct 4</h4>
                    <div class="candidate-list">
                        <a href="profiles/jen-crownover.html" class="candidate-chip">Jen Crownover <span style="color: var(--text-muted);">(Unopposed)</span></a>
                    </div>
                </div>

                <!-- Justice of Peace Races -->
                <div class="compact-race">
                    <h4>Justice of Peace Precinct 1</h4>
                    <div class="candidate-list">
                        <div class="candidate-chip incumbent">
                            <span class="incumbent-star">‚òÖ</span>
                            Tom Clark (Incumbent)
                        </div>
                    </div>
                </div>

                <!-- County Clerk Race -->
                <div class="compact-race">
                    <h4>Comal County Clerk</h4>
                    <div class="candidate-list">
                        <div class="candidate-chip">Ryan Bourbon-Stuart</div>
                        <div class="candidate-chip">Garrison Maurer</div>
                        <div class="candidate-chip">LeAnn Miller</div>
                        <div class="candidate-chip">Romelle 'Melle' Walkup</div>
                    </div>
                </div>

                <!-- County Judge Race -->
                <div class="compact-race">
                    <h4>Comal County Judge <span style="color: var(--red);">(Vacant after Krause's passing)</span></h4>
                    <div class="candidate-list">
                        <div class="candidate-chip">Kristen Hoyt</div>
                        <div class="candidate-chip">Kayne Parrish</div>
                    </div>
                </div>

                <!-- Congressional Races -->
                <div class="compact-race">
                    <h4>US House District 21 (Republican Primary)</h4>
                    <div class="candidate-list">
                        <div class="candidate-chip">Mark Teixeira</div>
                        <div class="candidate-chip">Paul Rojas</div>
                        <div class="candidate-chip">Others</div>
                    </div>
                </div>
            </div>

            <!-- MUNICIPAL ELECTION - May 2, 2026 -->
            <div class="election-date-section">
                <h3>Municipal Election ‚Äî May 2, 2026</h3>

                <div class="compact-race">
                    <h4>Mayor ‚Äî New Braunfels</h4>
                    <div class="candidate-list">
                        <a href="profiles/neal-linnartz.html" class="candidate-chip incumbent">
                            <span class="incumbent-star">‚òÖ</span>
                            Neal Linnartz
                        </a>
                        <a href="profiles/michael-french.html" class="candidate-chip">Michael French</a>
                        <a href="profiles/bradley-porter.html" class="candidate-chip">Bradley Porter</a>
                        <a href="profiles/angela-allen.html" class="candidate-chip">Angela Allen</a>
                        <a href="profiles/jonathon-frazier.html" class="candidate-chip">Jonathon Frazier</a>
                    </div>
                </div>

                <div class="compact-race">
                    <h4>City Council District 5</h4>
                    <div class="candidate-list">
                        <a href="profiles/mary-ann-labowski.html" class="candidate-chip incumbent">
                            <span class="incumbent-star">‚òÖ</span>
                            Mary Ann Labowski <span style="color: var(--text-muted);">(No challengers yet)</span>
                        </a>
                    </div>
                </div>

                <div class="compact-race">
                    <h4>City Council District 6</h4>
                    <div class="candidate-list">
                        <a href="profiles/april-ryan.html" class="candidate-chip incumbent">
                            <span class="incumbent-star">‚òÖ</span>
                            April Ryan <span style="color: var(--text-muted);">(No challengers yet)</span>
                        </a>
                    </div>
                </div>
            </div>

            <!-- GENERAL ELECTION - November 3, 2026 -->
            <div class="election-date-section">
                <h3>General Election ‚Äî November 3, 2026</h3>
                
                <div class="compact-race">
                    <h4>State Representative District 73</h4>
                    <div class="candidate-list">
                        <a href="profiles/carrie-isaac.html" class="candidate-chip incumbent">
                            <span class="incumbent-star">‚òÖ</span>
                            Carrie Isaac (R)
                        </a>
                        <div class="candidate-chip">TBA (Democratic nominee)</div>
                    </div>
                </div>

                <div class="compact-race">
                    <h4>State Senator District 25</h4>
                    <div class="candidate-list">
                        <a href="profiles/donna-campbell.html" class="candidate-chip incumbent">
                            <span class="incumbent-star">‚òÖ</span>
                            Donna Campbell (R)
                        </a>
                        <div class="candidate-chip">TBA (Democratic nominee)</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- UNIFIED LATEST NEWS SECTION -->
        <div class="star-divider">‚òÖ ‚òÖ ‚òÖ</div>
        <div class="section-header">
            <h2>üì∞ Latest News</h2>
            <p>Candidate updates, policy changes, and business developments</p>
        </div>
        
        <div class="news-section">
            <div id="unified-news">
                <p style="color:var(--text-muted);">Loading latest stories...</p>
            </div>
        </div>

        <!-- ELECTION CALENDAR -->
        <div class="star-divider">‚òÖ ‚òÖ ‚òÖ</div>
        <div class="section-header">
            <h2>üìÖ Election Calendar</h2>
            <p>Important dates for the 2026 election cycle</p>
        </div>
        <div id="election-calendar" class="calendar-grid"></div>

        <!-- CURRENT OFFICIALS -->
        <div class="star-divider">‚òÖ ‚òÖ ‚òÖ</div>
        <div class="section-header">
            <h2>üë• Current Officials</h2>
            <p>Elected representatives serving Comal County</p>
        </div>
        <div id="officials-grid" class="officials-section"></div>
    </div>

    <div id="site-footer"></div>

    <script src="js/utils.js?v=8"></script>
    <script src="js/feed-renderer.js?v=10"></script>
    <script src="js/layout.js?v=10"></script>
    <script>
    (function () {
        'use strict';

        // Load all feeds and create unified news layout
        async function loadUnifiedNews() {
            try {
                const [candidateData, policyData, businessData] = await Promise.all([
                    fetchFeed('data/candidate-news.json'),
                    fetchFeed('data/policy-feed.json'),
                    fetchFeed('data/business-watch.json')
                ]);

                // Add category to each entry
                const candidateEntries = candidateData.map(entry => ({ ...entry, feedCategory: 'candidates' }));
                const policyEntries = policyData.map(entry => ({ ...entry, feedCategory: 'policy' }));
                const businessEntries = businessData.map(entry => ({ ...entry, feedCategory: 'business' }));

                // Combine and sort all entries by date (newest first)
                const allEntries = [...candidateEntries, ...policyEntries, ...businessEntries];
                allEntries.sort((a, b) => new Date(b.date) - new Date(a.date));

                renderUnifiedNewsLayout(allEntries);
            } catch (error) {
                console.error('Failed to load news feeds:', error);
                document.getElementById('unified-news').innerHTML = 
                    '<p style="color:var(--text-muted);font-style:italic;">Unable to load news stories.</p>';
            }
        }

        function renderUnifiedNewsLayout(allEntries) {
            const container = document.getElementById('unified-news');
            if (!allEntries.length) {
                container.innerHTML = '<p style="color:var(--text-muted);font-style:italic;">No news stories available.</p>';
                return;
            }

            const featured = allEntries[0]; // Most recent story
            const compactStories = allEntries.slice(1, 4); // Next 2-3 stories
            const fullWidthStories = allEntries.slice(4, 10); // Remaining stories

            let html = '<div class="news-featured-row">';
            
            // Featured story (left)
            const featuredUrl = featured.sourceUrl || '#';
            const featuredTarget = featuredUrl.startsWith('http') ? ' target="_blank" rel="noopener"' : '';
            html += `<a href="${escapeHtml(featuredUrl)}"${featuredTarget} class="featured-story">`;
            if (featured.image) {
                html += `<img src="${escapeHtml(featured.image)}" alt="${escapeHtml(featured.title || '')}" class="story-image">`;
            }
            html += '<div class="story-content">';
            html += `<h3 class="story-title">${escapeHtml(featured.title || '')}</h3>`;
            html += `<p class="story-summary">${escapeHtml(featured.summary || '')}</p>`;
            html += '<div class="story-meta">';
            html += `<span class="category-badge ${featured.feedCategory}">${formatCategoryLabel(featured.feedCategory)}</span>`;
            html += `<span>${formatStoryDate(featured.date)}</span>`;
            html += `<span>${escapeHtml(featured.source || '')}</span>`;
            html += '</div>';
            html += '</div></a>';

            // Compact stories (right)
            html += '<div class="compact-stories">';
            compactStories.forEach(story => {
                const storyUrl = story.sourceUrl || '#';
                const storyTarget = storyUrl.startsWith('http') ? ' target="_blank" rel="noopener"' : '';
                html += `<a href="${escapeHtml(storyUrl)}"${storyTarget} class="compact-story">`;
                html += `<h4 class="story-title">${escapeHtml(story.title || '')}</h4>`;
                html += '<div class="story-meta">';
                html += `<span class="category-badge ${story.feedCategory}">${formatCategoryLabel(story.feedCategory)}</span>`;
                html += `<span>${formatStoryDate(story.date)}</span>`;
                html += `<span>${escapeHtml(story.source || '')}</span>`;
                html += '</div>';
                html += '</a>';
            });
            html += '</div>';
            
            html += '</div>'; // End featured row

            // Full-width stories
            if (fullWidthStories.length > 0) {
                html += '<div class="full-width-stories">';
                fullWidthStories.forEach(story => {
                    const storyUrl = story.sourceUrl || '#';
                    const storyTarget = storyUrl.startsWith('http') ? ' target="_blank" rel="noopener"' : '';
                    html += `<a href="${escapeHtml(storyUrl)}"${storyTarget} class="full-width-story">`;
                    html += '<div class="story-content">';
                    html += `<h4 class="story-title">${escapeHtml(story.title || '')}</h4>`;
                    html += `<p class="story-summary">${escapeHtml(story.summary || '')}</p>`;
                    html += '<div class="story-meta">';
                    html += `<span class="category-badge ${story.feedCategory}">${formatCategoryLabel(story.feedCategory)}</span>`;
                    html += `<span>${formatStoryDate(story.date)}</span>`;
                    html += `<span>${escapeHtml(story.source || '')}</span>`;
                    html += '</div>';
                    html += '</div>';
                    html += '</a>';
                });
                html += '</div>';
            }

            // "View All News" link
            if (allEntries.length > 10) {
                html += '<div style="text-align: center; margin-top: 32px;">';
                html += '<a href="feeds/news.html" style="display: inline-block; padding: 14px 32px; background: var(--navy); color: white; text-decoration: none; font-weight: 600; font-size: 16px; border-radius: 6px; transition: background 0.2s;">View All ' + allEntries.length + ' Stories ‚Üí</a>';
                html += '</div>';
            }

            container.innerHTML = html;
        }

        function formatCategoryLabel(category) {
            const labels = {
                candidates: 'Candidates',
                policy: 'Policy',
                business: 'Business'
            };
            return labels[category] || category;
        }

        function formatStoryDate(dateStr) {
            try {
                const date = new Date(dateStr);
                return date.toLocaleDateString('en-US', { 
                    year: 'numeric', 
                    month: 'short', 
                    day: 'numeric' 
                });
            } catch (e) {
                return '';
            }
        }

        // Load officials data and render other sections
        fetch('data/officials.json')
            .then(function (r) { return r.json(); })
            .then(function (data) {
                renderAlertBanner(data);
                renderElectionCalendar(data);
                renderOfficials(data);
            })
            .catch(function (err) {
                console.error('Failed to load officials data:', err);
            });

        function renderAlertBanner(data) {
            var upcoming = (data.election_calendar || []).filter(function (e) { return e.upcoming; });
            if (upcoming.length > 0) {
                document.getElementById('alert-banner').innerHTML =
                    '<div class="alert-banner">' +
                    '  <div class="alert-icon">üó≥Ô∏è</div>' +
                    '  <div class="alert-text">' +
                    '    <h3>Upcoming: ' + upcoming[0].event + '</h3>' +
                    '    <p>' + upcoming[0].date + ' ‚Äî Mark your calendars and make your voice heard!</p>' +
                    '  </div>' +
                    '</div>';
            }
        }

        function renderElectionCalendar(data) {
            var calEl = document.getElementById('election-calendar');
            var html = '';
            (data.election_calendar || []).forEach(function (item) {
                var cls = item.upcoming ? 'calendar-item upcoming' : 'calendar-item';
                html += '<div class="' + cls + '">' +
                    '<div class="cal-date">' + item.date + '</div>' +
                    '<div class="cal-event">' + item.event + '</div>' +
                    '</div>';
            });
            calEl.innerHTML = html;
        }

        function renderOfficials(data) {
            var gridEl = document.getElementById('officials-grid');
            var officials = data.current_officials || [];
            var city = officials.filter(function (o) { return o.group === 'city'; });
            var countyState = officials.filter(function (o) { return o.group === 'county' || o.group === 'state'; });

            var html = '<div class="officials-group"><h3>City of New Braunfels</h3>';
            city.forEach(function (o) {
                html += officialRow(o);
            });
            html += '</div>';

            html += '<div class="officials-group"><h3>County &amp; State</h3>';
            countyState.forEach(function (o) {
                html += officialRow(o);
            });
            html += '</div>';

            gridEl.innerHTML = html;
        }

        function officialRow(o) {
            var photoHtml = o.photo
                ? '<img class="official-photo" src="' + o.photo + '" alt="' + o.name + '" loading="lazy">'
                : '';
            var link = 'profiles/' + o.slug + '.html';
            var termStr = o.term ? ' (' + o.term + ')' : '';
            return '<a href="' + link + '" class="official-row">' +
                photoHtml +
                '<span class="name">' + o.name + '</span>' +
                '<span class="title">' + o.title + termStr + '</span>' +
                '</a>';
        }

        // Load unified news feed
        loadUnifiedNews();

        // Initialize auto-linking for candidate names
        document.addEventListener('DOMContentLoaded', function() {
            // Auto-link candidate names in news content, elections section, and other text
            setTimeout(function() {
                initAutoLinking([
                    '#unified-news',
                    '.election-date-section',
                    '.compact-race',
                    '.featured-story .story-content',
                    '.compact-story',
                    '.full-width-story .story-content'
                ], '');
            }, 1000); // Wait for content to load
        });
    })();
    </script>
</body>
</html>
